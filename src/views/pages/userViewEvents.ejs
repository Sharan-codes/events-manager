<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>View Events</title>
  <!-- MDB icon -->
  <link rel="icon" href="img/mdb-favicon.ico" type="image/x-icon">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
  <!-- Bootstrap core CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.12.0/css/mdb.min.css" rel="stylesheet">
  <!-- Your custom styles (optional) -->
  <link rel="stylesheet" href="css/table.css" type="text/css">
</head>
<body>
  <div class="col-md-12 mt-3 bg-dark pb-2 border border-warning">
    <h1 class="text-warning mt-5">Events</h1>
  </div>
  <div class="row offset-1">
    <div class="col-md-5">
  <h2 class="text-success">Hi <%= user %></h2>
</div>
  <div class="col-md-6">
    <a href="/logout"><button class="btn btn-outline-dark mt-2 mr-4 float-right">Logout</button></a>
  </div>
</div>
<div class="col-md-11" style="margin-left: 5%;">
    <div class="col-md-12 mt-3 bg-dark p-2 border border-warning">
      <h3 class="text-success text-center">Bookings open</h3>
    </div>
<table id="dtVerticalScrollExample" class="table table-striped table-bordered" cellspacing="0"
  width="100%" height="100%">
  <thead>
      <tr>
        <th>Event name</th>
        <th>Booking start time</th>
        <th>Booking end time</th>
        <th>Ticket price</th>
        <th>Available tickets</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <%if (records.length >0){ %>
      <% records.forEach(function(row){ %>
      <% var startDate = new Date(row.bookStartTime); %>
      <% var endDate = new Date(row.bookEndTime); %>
      <tr>
        <td><%= row.eventName %></td>
        <td><%= startDate.toDateString()+", "+startDate.toLocaleTimeString(); %></td>
        <td><%= endDate.toDateString()+", "+endDate.toLocaleTimeString(); %></td>
        <td><%= row.ticketPrice %></td>
        <td><%= row.availableTickets %></td>
        <% var bookStatus = ""; %>
        <% if (row.availableTickets === 0){ bookStatus = " [SOLD OUT]"; }%>
        <!-- <td><a href="/eventDetails?eventName=<%= row.eventName %>&bookStartTime=<%= row.bookStartTime %>&bookEndTime=<%= row.bookEndTime %>&ticketPrice=<%= row.ticketPrice %>&totalTickets=<%= row.totalTickets %>&availableTickets=<%= row.availableTickets %>&status=<%= row.status %>" > -->
        <td><a href="/userEventDetails?eventId=<%= row.eventId %>&eventName=<%= row.eventName %>">
            <button class="btn btn-dark text-warning">VIEW<span class="text-danger"><%= bookStatus %></span></button></a></td>
      </tr>
      <% })}else{ %>
        <tr>
            <td colspan="6">Bookings not open for any events now</td>   
          </tr>
        <% } %>
    </tbody>
  </table>
</div>
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  <script src="js/myscripts.js" type="text/javascript"></script>  
</body>
</html>
